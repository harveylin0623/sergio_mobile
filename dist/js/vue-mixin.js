!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).authMixin=t()}(this,function(){return{data(){return{myHeader:null,authKey:"knn-userInfo",logoutGoHome:!0}},methods:{updateHeaderAuth(e){this.$store.commit("setAuth",e),this.myHeader.setAuthStatus(e)},removeUserInStroageData(){window.storageObj.removeItem(this.authKey),window.sessionStorageObj.removeItem("cart-item-data"),window.sessionStorageObj.removeItem("cart-user-data")},async logoutHandler(){if(this.isLoading=!0,await authApi.loginOut({url:this.apiUrl.logout,data:{}}),this.removeUserInStroageData(),!this.logoutGoHome)return this.updateHeaderAuth(!1),void(this.isLoading=!1);location.href=this.pageUrl.home},async checkTokenIsValid({throwError:e}){if(1===(await authApi.checkToken({url:this.apiUrl.me,data:{}})).status)return this.updateHeaderAuth(!0);var t=await authApi.refreshToken({url:this.apiUrl.refresh,data:{}});if(1===t.status){let e=window.storageObj.getItem(this.authKey);e.token=t.aaData.access_token,window.storageObj.setItem(this.authKey,e),this.updateHeaderAuth(!0)}else if(this.removeUserInStroageData(),e)throw window.sessionStorageObj.setItem("backUrl",{url:location.href}),$("#reloginPopup").modal("show"),this.isLoading=!1,new Error("auth token is expired")}},mounted(){this.myHeader=this.$refs.header}}}),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).registerListMixin=t()}(this,function(){return{data(){return{genderList:[{title:"男",value:"M"},{title:"女",value:"F"},{title:"保密",value:"S"}],questionList:[{title:"您畢業的國小",value:"sq01"},{title:"您最愛的寵物名字",value:"sq02"},{title:"您最愛的食物",value:"sq03"},{title:"您最好朋友的名字",value:"sq04"},{title:"您最愛的電影",value:"sq05"},{title:"您的姓名",value:"sq06"},{title:"您的生日",value:"sq07"}]}}}}),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).userAddressMixin=t()}(this,function(){return{data(){return{zipcodeData:window.zipcodeData,addressInfo:{city:"",district:"",code:0,road:""}}},computed:{cityList(){return 0===this.zipcodeData.length?[]:this.zipcodeData.map(e=>e.name)},districtList(){var e=this.zipcodeData.find(e=>e.name===this.addressInfo.city);return void 0!==e?e.region:[]}},watch:{districtList(){this.addressInfo.district=""},"addressInfo.district"(t){var e=this.districtList.find(e=>e.name===t);this.addressInfo.code=void 0!==e?e.code:0}}}}),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).processProductMixin=t()}(this,function(){return{methods:{processProduct(e){return e.reduce((e,t)=>{var{product_code:t,product_name:i,main_image:r,product_price:o,product_promo_price:s,category_id:a}=t,a=this.pageUrl.productDetail+`?productCode=${t}&category_id=`+a;return e.push({product_code:t,product_name:i,main_image:r,product_price:o,product_promo_price:s,linkUrl:a}),e},[])}}}}),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).createSpecSlideListMixin=t()}(this,function(){return{methods:{createSpecSlideList(e){return e.reduce((e,t)=>e=e.concat(t.images),[])}}}}),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).createNewsPopulartMixin=t()}(this,function(){return{methods:{createNewsPopular(e){return e.reduce((e,t)=>{var{id:t,title:i,images:r}=t,r=void 0!==r[0]?r[0]:"",o=this.pageUrl.newsDetail+"?newsId="+t;return e.push({id:t,title:i,imgUrl:r,linkUrl:o}),e},[])}}}}),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).encodePhoneTextMixin=t()}(this,function(){return{computed:{encodePhoneText(){let e=this.user.mobile;return""===e?"":e.replace(e.substring(4,8),"****")}}}}),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).contactMixin=t()}(this,function(){return{methods:{async contactHandler(e){this.isLoading=!0;let t=null;try{t=await customerServiceApi.online_service_create({url:this.apiUrl.online_service_create,data:{type:"product",product_code:this.productInfo.product_code,order_num:"",title:e.title,message:e.message}})}catch(e){return this.$refs.contactModal.closeModal(),void(this.isLoading=!1)}this.tipInfo.status=1===t.status,this.tipInfo.message=t.message,this.$refs.contactModal.closeModal(this.tipInfo.status),$("#tipPopup").modal("show"),this.isLoading=!1}}}}),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).checkBarcodeMixin=t()}(this,function(){return{methods:{async checkBarcodeIsValid(e){e="Y"===(await invoiceApi.check_barcode({url:this.apiUrl.check_barcode,data:{barcode:e}})).data.IsExist;return{status:e,message:e?"":"無效的手機載具"}}}}}),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).initFlatPickerMixin=t()}(this,function(){return{data(){return{flatPicker:null,minMinusDay:90}},methods:{formatDate(e){return void 0===e?"":dayjs(e).format("YYYY/MM/DD")},initFlatPicker(){var e=dayjs().toDate(),t=dayjs().subtract(this.minMinusDay,"day").toDate();this.flatPicker=new flatpickr("#dateInput",{dateFormat:"Y/m/d",minDate:t,maxDate:e,defaultDate:e,disableMobile:"true",locale:"zh_tw",monthSelectorType:"static"})}}}}),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).fullLabelActivityMixin=t()}(this,function(){return{data(){return{promoteId:0,productLists:[],pickList:[],activityMenuIsOpen:!1,pickedMenuIsOpen:!1,activityIntro:{title:"",summary:""},condition:{activityId:-1,promo_type:1,min_amount:0,promo_amount:0,code:"",imgUrl:""},paginationInfo:{currentPage:1,totalPage:1,perPage:10},introInfo:{name:"",summary:"",specTitle:"",price:0,imgUrl:""},tipInfo:{status:!1,message:""},limitedText:"",logoutGoHome:!1,isLoading:!1}},computed:{hasCriteria(){return-1!==this.condition.activityId},pickedTotal(){return this.pickList.reduce((e,t)=>e+=t.buyCount,0)},pickedAmount(){return this.pickList.reduce((e,t)=>e+=t.buyCount*t.price,0)},hasPicked(){return 0<this.pickedTotal},showPickedMenu(){return this.hasPicked&&this.pickedMenuIsOpen}},methods:{checkProductHasStock(e){return e.filter(e=>{e=e.spec;return null!==e&&0<e.spec_stock})},setCondition(e){this.condition.activityId=e.id,this.condition.promo_type=e.promo_type,this.condition.min_amount=e.min_amount,this.condition.promo_amount=e.promo_amount,this.condition.code=e.code,this.condition.imgUrl=e.images[0]||"",this.activityIntro.title=e.title,this.activityIntro.summary=e.summary},toggleActivityMenu(){this.activityMenuIsOpen=!this.activityMenuIsOpen},togglePickedMenu(){this.hasPicked&&(this.pickedMenuIsOpen=!this.pickedMenuIsOpen)},pickHandler(e){let t=e["activityProductId"];void 0===this.pickList.find(e=>e.activityProductId===t)&&this.pickList.push({...e,buyCount:1})},changePickCount(e){let{activityProductId:t,count:i}=e,r=this.pickList.find(e=>e.activityProductId===t);r.buyCount=i},removePickedItem({activityProductId:t}){var e=this.pickList.findIndex(e=>e.activityProductId===t);this.pickList.splice(e,1)},introHandler(e){this.introInfo=e,$("#activityProductPopup").modal("show")},async paginationChange({pageNumber:e}){this.isLoading=!0,this.paginationInfo.currentPage=e,await this.getActivtyProduct(),window.scrollTo(0,0),this.isLoading=!1},limitedReminder(e){this.limitedText=e,$("#limit-popup").modal("show")},getPickedProductParams(){return this.pickList.reduce((e,t)=>{var{activityProductId:t,product_code:i,specId:r,buyCount:o}=t;return e.push({activity_meta_id:t,product_code:i,spec_id:r,count:o}),e},[])},async addToCart(e){this.isAchieved&&(this.isLoading=!0,e=await cartApi.product_promotions({url:this.apiUrl.product_promotions,data:{code:e,count:1,products:this.getPickedProductParams(),activity_product_promotions_id:this.promoteId}}),this.tipInfo.status=1===e.status,this.tipInfo.message=e.message,this.tipInfo.status&&(this.pickList=[],this.myHeader.updateCartCount(e.cartTotal)),$("#tipPopup").modal("show"),this.isLoading=!1)}}}}),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).userBirthdayMixin=t()}(this,function(){return{data(){return{birthdayIsValid:!0,userBirthday:{year:(new Date).getFullYear(),month:(new Date).getMonth()+1}}},computed:{yearList(){let i=(new Date).getFullYear()-100;return Array.from({length:101},(e,t)=>{t+=i;return{text:t+"年",value:t}}).reverse()},monthList(){let e=new Date;var t=e.getFullYear();let i=[];return i=this.userBirthday.year===t?(t=e.getMonth(),this.createMonth(t)):this.createMonth(11)}},methods:{createMonth(e){return Array.from({length:e+1},(e,t)=>{t+=1;return{text:t+"月",value:t}})},createBirthdayText(e){var{year:t,month:i}=this.userBirthday,t=new Date(t,i-1,1),i=e?"YYYY/MM/DD":"YYYY/MM";return dayjs(t).format(i)},checkBirthdayIsValid(){var{year:e,month:t}=this.userBirthday,e=dayjs(e+`-${t}-1`);let i=dayjs().date(1);t=7<=i.diff(e,"year",!0);return this.birthdayIsValid=t}},watch:{monthList(e){e.length<12&&(e=(new Date).getMonth()+1,this.userBirthday.month>e&&(this.userBirthday.month=1))},userBirthday:{deep:!0,handler(){this.checkBirthdayIsValid()}}}}}),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).cartDescMixin=t()}(this,function(){return{data(){return{paymentLimit:`
					<p>1.宅配配送：</p>
					<div class="pl-2">
						<p>(1)信用卡：$33<= 付款金額 <= $199,999</p>
						<p>(2)WebATM/ATM ：$11<= 付款金額 <= $49,999</p>
						<p>(3)超商代碼：$33<= 付款金額 <= $20,000</p>
						<p>(4)超商條碼：$17< =付款金額 <= $20,000</p>
					</div>
					<p>2.超商取貨：付款金額 <= $20,000</p>
					<p>3.ATM付款：ATM付款產生之虛擬帳號，僅能使用ATM櫃員機及網路銀行轉帳，無法臨櫃轉帳付款。</p>
				`,warningText:`
					<li>※因拍攝燈光、電腦解析度、電腦螢幕廠牌不同，實品與網頁上商品可能會有些許色差。</li>
					<li>※商品包裝會隨著廠商而不定時更換新包裝，商品依實際出貨為準。</li>
					<li>※商品如遇缺貨/停產/訂單相關問題，客服會與您聯繫【MAIL/電話/簡訊】取消或變更訂單。</li>
					<li>※如購買大量-配送方式選擇【超商取貨】，請先與客服確認是否可配送【超商有材積/重量限制】。</li>
					<li>※您要結帳的商品若與您所選取的付款方式或寄送方式不相符將無法在同一訂單內結帳。</li>
					<li>※若商品僅加入購物車，系統不會保留商品。需完成訂單填寫且訂單成立才會予以保留。</li>
					<li>※本網站不會主動打電話要求您操作ATM或透露存款餘額，若您接到類似可疑電話，請撥打165專線確認，以確保您的權益。</li>
					<li>※如有其他問題，請先參考頁面下方【購物說明】。</li>
				`,preorderPaymentLimit:`
					<div class="pl-2">
						<p>(1)信用卡：$33<= 付款金額 <= $199,999</p>
						<p>(2)WebATM/ATM ：$11<= 付款金額 <= $49,999</p>
						<p>(3)超商代碼：$33<= 付款金額 <= $20,000</p>
						<p>(4)超商條碼：$17< =付款金額 <= $20,000</p>
					</div>
				`}}}}),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).cartParamsMixin=t()}(this,function(){return{data(){return{invoiceList:[{id:"3",title:"電子發票",placeholder:"請填寫email",apiName:"invoice_email",display:!0},{id:"1",title:"手機載具",placeholder:"請填寫手機載具",apiName:"invoice_phone_id",display:!0},{id:"2",title:"自然人憑證",placeholder:"請填寫自然人憑證",apiName:"invoice_user_id",display:!0},{id:"4",title:"捐贈碼",placeholder:"",apiName:"invoice_love_id",display:!0},{id:"5",title:"公司行號",placeholder:"請輸入統一編號",apiName:"invoice_num",display:!0}],loveInstitution:[{id:"8957282",title:"財團法人流浪動物之家基金會"},{id:"885521",title:"財團法人中華民國兒童福利聯盟文教基金會"},{id:"17930",title:"社團法人台灣環境資訊協會"}],mappingActivityCode:{normal:"一般商品",full_amount_price:"滿額活動",full_amount_count:"滿件活動",red_with_green:"紅配綠",limit_time:"限時限量活動",preorder:"預購活動",groupbuy:"急殺活動",purchase:"加價購"},mappingPaymentType:{Credit:"信用卡",WebATM:"WebATM",ATM:"ATM",CVS:"超商代碼繳款",BARCODE:"超商條碼繳款",CVSPickupPay:"超商取貨付款",StorePickupPay:"門市取貨付款"},mappingDeliveryCode:{HOME:"宅配",CVS:"超商取貨",STORE:"門市取貨"},mappingMarketCode:{FAMI:"全家",UNIMART:"7-11",HILIFE:"萊爾富",FAMIC2C:"全家",UNIMARTC2C:"7-11",HILIFEC2C:"萊爾富",OKMARTC2C:"OK"}}}}}),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).cartStep1LogicMixin=t()}(this,function(){return{data(){return{cartList:[],addOnList:[],purchaseList:[],receipentList:[],pickedTicket:[],showLimitedDesc:!1,isDeposit:!1,isLoading:!1,canUpdateHeaderCount:!1,deliveryType:"",limitedText:"",paymentInfo:{type:"",list:[]},introInfo:{name:"",summary:"",imgUrl:"",specTitle:"",price:0},otherError:{status:!1,message:""}}},computed:{hasCartItem(){return 0<this.cartList.length},purchaseItemSubtotal(){return this.addOnList.filter(e=>e.isChecked).reduce((e,t)=>e+=t.count*t.purchase_price,0)},paymentList(){return this.paymentInfo.list.map(({id:e,type:t,title:i})=>({id:e,type:t,title:i})).filter(e=>"WebATM"!==e.type)},deliveryList(){var e=this.paymentInfo.list.find(e=>e.type===this.paymentInfo.type);return void 0!==e?e.relationship:[]},transportList(){let e=this.paymentInfo.list.find(e=>e.type===this.paymentInfo.type);if(void 0===e)return[];var t=e.relationship.find(e=>"HOME"===e.type);return void 0!==t&&t.sub||[]},marketList(){let e=this.paymentInfo.list.find(e=>e.type===this.paymentInfo.type);if(void 0===e)return[];var t=e.relationship.find(e=>"CVS"===e.type);return void 0!==t&&t.sub||[]},hasReceipent(){return 0<this.receipentList.length},hasPickedTicket(){return 0<this.pickedTicket.length}},methods:{initPurchaseSlide(){new Swiper(".addOn-swiper",{slidesPerView:2,spaceBetween:0,slidesPerGroup:2,loop:!1,navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"}})},setPurchaseCheck(t){let e=this.addOnList.find(e=>e.id===t.id);e.isChecked=t.checked},async purchaseBuy(t){var e=this.addOnList.find(e=>e.purchase_id===t.purchase_id);if(void 0===e){this.isLoading=!0;e=await cartApi.cart_purchase({url:this.apiUrl.cart_purchase,data:{...t}});if(1!==e.status)return this.isLoading=!1;var i=this.processNormalCart([e.cartPurchase]);this.addOnList.push(i[0]),this.canUpdateHeaderCount&&this.myHeader.updateCartCount(e.cartTotal),this.isLoading=!1}},async setPurchaseCount(t){this.isLoading=!0;var e=await cartApi.cart_purchase({url:this.apiUrl.cart_purchase,data:{...t}});if(1!==e.status)return this.isLoading=!1;let i=this.addOnList.find(e=>e.purchase_id===t.purchase_id);i.count=t.count,this.canUpdateHeaderCount&&this.myHeader.updateCartCount(e.cartTotal),this.isLoading=!1},async removePurchaseItem(t){this.isLoading=!0;var e=await cartApi.cart_purchase({url:this.apiUrl.cart_purchase+"/"+t.id,method:"delete"});if(1!==e.status)return this.isLoading=!1;var i=this.addOnList.findIndex(e=>e.id===t.id);this.addOnList.splice(i,1),this.canUpdateHeaderCount&&this.myHeader.updateCartCount(e.cartTotal),this.isLoading=!1},setMarketType(e){this.$refs.cvsDeliveryForm.openDigitalMap(e)},setHomeDeliveryFormData(e,t="receiver"){this.$refs.homeDeliveryForm.setCharacterData(e,t)},chooseTicket(e){this.pickedTicket=_.cloneDeep(e)},setPickedTickChecked(t){let e=this.pickedTicket.find(e=>e.coupon_no===t.coupon_no);void 0!==e&&(e.isChecked=t.checked)},introPurchase(e){this.introInfo=e,$("#activityProductPopup").modal("show")},limitedReminder(e){this.limitedText=e,$("#limit-popup").modal("show")},saveUserData(){let e={paymentType:this.paymentInfo.type,deliveryType:this.deliveryType,invoiceInfo:this.$refs.invoiceForm.getData(),isDeposit:this.isDeposit};var t;this.isDeposit||("HOME"===this.deliveryType?(t=this.$refs.homeDeliveryForm,e.isSameOrderer=t.isSameOrderer,e.orderer=t.orderer,e.receiver=t.receiver):"CVS"===this.deliveryType&&(t=this.$refs.cvsDeliveryForm,e.marketInfo=t.marketInfo,e.supermarket=t.supermarket)),window.sessionStorageObj.setItem(this.userStorageKey,e)},async validateUserData(){var e=this.deliveryType,t=await this.$refs.invoiceForm.validate(),{formIsValid:i,addressIsValid:r}=await this.$refs[{HOME:"homeDeliveryForm",CVS:"cvsDeliveryForm"}[e]].validate();return this.otherError.status=!r,this.otherError.message=r?"":{HOME:"請填寫完整的收件人和寄件人地址",CVS:"請選擇取貨超商"}[e],this.otherError.status&&$("#validatePopup").modal("show"),i&&t&&!this.otherError.status},async validateBarcode(){var e=this.$refs.invoiceForm;if("1"===e.invoiceInfo.id){this.isLoading=!0;e=await this.checkBarcodeIsValid(e.invoiceInfo.invoice_phone_id);if(this.otherError.status=e.status,this.otherError.message=e.message,!e.status)return $("#validatePopup").modal("show"),this.isLoading=!1}return!0},async setUserData(){var e=window.sessionStorageObj.getItem(this.userStorageKey),t=window.storageObj.getItem("knn-userInfo");let i=this.$refs.homeDeliveryForm,r=this.$refs.cvsDeliveryForm,o=this.$refs.invoiceForm;this.hasCartItem&&(o.invoiceInfo.invoice_email=t.email,o.invoiceInfo.invoice_phone_id=t.einvoice_carrier_no||""),null!==e&&("HOME"!==e.deliveryType||this.isDeposit||(this.setHomeDeliveryFormData(e.orderer,"orderer"),i.setUserTel(e.orderer.tel,"orderer"),i.setRemark(e.receiver.remark),e.isSameOrderer?i.setIsSameValue(e.isSameOrderer):(this.setHomeDeliveryFormData(e.receiver,"receiver"),i.setUserTel(e.receiver.tel,"receiver"))),"CVS"!==e.deliveryType||this.isDeposit||(r.marketInfo=e.marketInfo,r.supermarket=e.supermarket,this.$refs.marketModal.setDefaultMarketType(e.marketInfo.type)),this.paymentInfo.type=e.paymentType,await this.$nextTick(),this.deliveryType=e.deliveryType,o.invoiceInfo=e.invoiceInfo)}},watch:{deliveryList(e){this.deliveryType=e[0].type}}}}),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).cartStep2LogicMixin=t()}(this,function(){return{data(){return{cartList:[],addOnList:[],couponList:[],backupCartData:{},backupUserData:{},paymentType:"",deliveryType:"",isLoading:!1,apiIsReady:!1,isDeposit:!1,orderer:{name:"",email:"",mobile:"",tel:"",city:"",district:"",address:""},receiver:{name:"",email:"",mobile:"",tel:"",city:"",district:"",address:"",remark:""},marketInfo:{type:"",CVSAddress:"",CVSOutSide:"",CVSStoreID:"",CVSStoreName:"",CVSTelephone:""},invoiceInfo:{id:"",invoice_email:"",invoice_phone_id:"",invoice_love_id:"",invoice_user_id:"",invoice_num:"",companyTitle:"",companyAddress:""},cartErrorInfo:{isRemaining:{status:!0,text:"『尚有其他商品因付款方式和物流限制不同，還保留在購物車中未帶入訂單，若有使用票券將可能因條件不符被移除，請再次確認您的商品清單，謝謝。』"},isCouponRemaining:{status:!0,text:"您所選取的票券，因購買商品內容及使用規則限制而有所異動，請確認訂單內有計入的票券內容，謝謝。"}}}},computed:{paymentName(){return this.mappingPaymentType[this.paymentType]||""},deliveryName(){return this.mappingDeliveryCode[this.deliveryType]||""},marketName(){return"CVS"===this.deliveryType&&this.mappingMarketCode[this.marketInfo.type]||""},invoiceName(){var e=this.invoiceList.find(e=>e.id===this.invoiceInfo.id);return void 0!==e?e.title:""},loveInstitutionName(){var e=this.loveInstitution.find(e=>e.id===this.invoiceInfo.invoice_love_id);return void 0!==e?e.title:""},invoiceValue(){var e=this.invoiceList.find(e=>e.id===this.invoiceInfo.id);if(void 0===e)return"";e=e.apiName,e=this.invoiceInfo[e];return"4"===this.invoiceInfo.id?this.loveInstitutionName+`(${e})`:"5"===this.invoiceInfo.id?"統一編號: "+e+` ${"公司抬頭: "+this.invoiceInfo.companyTitle} `+("公司地址: "+this.invoiceInfo.companyAddress):e},startingPoint(){var{city:e,district:t,address:i}=this.orderer;return""+e+t+i},destination(){var e,t,i,r=this.deliveryType;let o="";return"HOME"===r?({city:t,district:i,address:e}=this.receiver,o=""+t+i+e):"CVS"===r?({CVSStoreName:t,CVSAddress:i}=this.marketInfo,o=t+`(${i})`):""===r&&(o=""),o},olListStyle(){let e=[];for(var t in this.cartErrorInfo)e.push(this.cartErrorInfo[t].status);return 1<e.filter(e=>e).length?"list-style-type: decimal;":""}},methods:{getUserFilledData(){var e=window.sessionStorageObj.getItem(this.userStorageKey);if(null===e)return this.handleCartDataError("購物車資料有誤");this.backupUserData=_.cloneDeep(e),this.isDeposit=e.isDeposit,this.paymentType=e.paymentType,this.deliveryType=e.deliveryType,this.invoiceInfo=e.invoiceInfo,this.isDeposit||("HOME"===this.deliveryType?(this.orderer=e.orderer,this.receiver=e.receiver):"CVS"===this.deliveryType&&(this.marketInfo=e.marketInfo,this.receiver=e.supermarket))},setHomeDeliveryInfo(e){return{name:e.name,contact:e.tel,phone:e.mobile,email:e.email,city:e.city,area:e.district,address:e.address,zip_code:e.code.toString(),remark:e.remark||""}},async pollingOrderStatus(e,t){var{status:i,form:r,order_status:o}=await orderApi.order_status({url:this.apiUrl.order_status+"/"+e});if(1!==i)return this.orderTip.status=!1,this.orderTip.message="訂單成立失敗",void this.handleOrderError();let{status:s,order_num:a}=o;this.orderTip.status=1===s,this.orderTip.message=2===s?"訂單成立失敗":"",0===s?setTimeout(()=>{this.pollingOrderStatus(e,t)},3e3):1===s?(window.sessionStorageObj.removeItem(this.cartStorageKey),window.sessionStorageObj.removeItem(this.userStorageKey),""!==r&&window.openThirdPartyPaymentWindow(r),setTimeout(()=>{location.href=`${this.pageUrl.cart_step3}?orderNumber=${a}&type=`+t},3e3)):2===s&&this.handleOrderError()},async createOrder(e){this.isLoading=!0;var t=this.gatherOrderParams(),t=await orderApi.order({url:this.apiUrl.order_create,data:t});this.orderTip.status=1===t.status,this.orderTip.message=t.message,0===t.status?this.handleOrderError():1===t.status?this.pollingOrderStatus(t.order_num,e):2===t.status&&this.handleCartDataError(t.message)},handleCartDataError(e){this.tipInfo.stataus=!1,this.tipInfo.message=e,$("#tipPopup").modal("show")},handleOrderError(){$("#orderPopup").modal("show"),this.isLoading=!1}}}}),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).orderPayMixin=t()}(this,function(){return{data(){return{orderStatusList:{0:"等待處理",1:"訂單處理中",2:"備貨中",4:"已出貨",6:"訂單已完成",7:"退貨處理中",8:"已退貨",9:"訂單取消"},payStatusList:{0:"未付款",1:"已付款",4:"已退款",11:"已取號"}}}}}),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).signUpStepMixin=t()}(this,function(){return{data(){return{stepList:[{text:"填寫資料",done:!1},{text:"手機驗證",done:!1}]}}}});